<!DOCTYPE html>
<html>

<head>
    <link rel="stylesheet" type="text/css" href="../../../doc/showcases.css">
	<title>Visualizing Transport Path Activity</title>
</head>

<body>
    <h1>Visualizing Transport Path Activity</h1>

    <p><h2>Goals</h2></p>
    <p>
        In complex networks it is difficult to trace the packets' path between processes on remote devices, because there are a lot of simultaneous communication and we have to pay attention to more than one message at the same time.
        The transport layer offers peer-to-peer and end-to-end connections between two processes on remote hosts.
        This layer is the first one which breaks the data in to smaller units called segments.
        Because a lot of data segments are traveling in the network simultaneously, it is really difficult to determine the data's path between two nodes.
    </p>
    <p>    
        The showcase consists of four simulation models, each demonstrating different features of transport path activity visualization.
    </p>
    <p>
        INET version: <var>3.6</var><br>
        Source files location: <var>inet/showcases/visualization/transportpathactivity</var>
    </p>


    <p><h2>About the Visualizer</h2></p>
    <p>
        In INET, transport path activity can be visualized by including a <var>TransportRouteVisualizer</var> module in the simulation.
        Adding an <var>IntegratedVisualizer</var> is also an option, because it also contains a <var>TransportRouteVisualizer</var>.
        Transport path activity visualization is disabled by default, it can be enabled by setting the visualizer's <var>displayRoutes</var> parameter to true.
    </p> 
    <p>
        TODO:<br> when all segments are arrived
        <var>TransportRouteVisualizer</var> currently observes packets that pass through the transport layer (i.e. carry data from/to higher layers), but not those that are internal to the operation of the transport layer protocol.
    </p>
    <p>
        The activity between two nodes is represented visually by a solid polyline arrow which points from the source node to the destination node.
        The arrow appears after the first packet has been received, then gradually fades out unless it is refreshed by further packets.
        Color, fading time and other graphical properties can be changed with parameters of the visualizer.
    </p>
    <p>
        By default, all packets, interfaces and nodes are considered for the visualization.
        This selection can be narrowed with the visualizer's <var>packetFilter</var> and <var>nodeFilter</var> parameters.
    </p>    


    <p><h2>Enabling Visualization of Transport Path Activity</h2></p>
    <p>
        The following example demonstrates how to enable the visualization with its default settings.
        We visualize activity both in a wired and in a wireless network.
    </p>
    <p>
        The wired and the wireless networks are very similar:
    </p>
    <p>
        <img class="screen" src="TransportPathVisualizerSimpleWired.png">
    </p>
    <p>
        <img class="screen" src="TransportPathVisualizerSimpleWireless.png">
    </p>
    <p>
        Both networks consist of two hosts.
        The <var>visualizer's</var> type is <var>TransportPathVisualizer</var>.
        The <var>source</var> has an <var>UDPBasicApp</var> application whose target is the <var>destination</var> host.
        The packets are handled by an <var>UDPSink</var> application in the <var>destination</var>.<br>
        An additional line of configuration enables the visualization:
    </p>
    <div class="snippet">
        *.routeVisualizer.*.displayRoutes = true
    </div>
    <p>
        Here is what happens when the simulation is run:
    </p>
    <p align="center">        
        <video autoplay loop controls onclick="this.paused ? this.play() : this.pause();" width=454 height=211 src="EnablingRoutesWired.mp4">
    </p>
    <p align="center">        
        <video autoplay loop controls onclick="this.paused ? this.play() : this.pause();" width=456 height=271 src="EnablingRoutesWireless.mp4">
    </p>
    <p>
        A starting transmission is represented by a dotted blue line between the nodes in the wireless configuration.
        This is a default OMNeT visualization.
        At the same time a red arrow goes from the transmitter node towards the receiver node.
        This arrow displays a traveling packet between the INET modules.
        Under this arrow we can see the packet's type and name.
        This is not the same as the path arrow, because the <var>TransportPathVisualizer</var> displays that packets' paths which goes down to the transport layer in the source and goes up from the transport layer in the destination.
        For example ARP packets go up only to the third layer in the destination node, so they don't activate the visualizer.
        When a packet which is born in an upper layer than the fourth is forwarded from the destination's network layer, the visualizer draws a path between the nodes and an arrow is shown pointing from the sender towards the receiver.
        For example we can see this if an <var>UDPBasicAppData</var> packet is sent.
    </p>


    <p><h2>Transport Path Activity Visualization in an Extended Network</h2></p>
    <p>
        In this configuration we demonstrate how to display activity between certain nodes.
        Here is the network for this configuration:
    </p>
    <p>
        <img width=850 class="screen" src="TransportPathVisualizerExtended.png">
    </p>
    <p>
        We set up a non-trivial network with five routers, four switches and eight endpoints.
        The <var>source</var> nodes generate the traffic by <var>UDPBasicApp</var>, which is handled by an <var>UDPSink</var> application in the <var>destination</var> nodes.
        We adjust the visualization's fade out parameters, so the arrows don't disappear completely before the next packet arrives to the destination.
        Here is the configuration of the visualization:
    </p>
    <div class="snippet">
        *.visualizer.*.transportRouteVisualizer.displayRoutes = true<br>
        *.visualizer.*.transportRouteVisualizer.fadeOutMode = "simulationTime"<br>
        *.visualizer.*.transportRouteVisualizer.fadeOutTime = 0.6s
    </div>
    <p>
        When we start the simulation, this happens:
    </p>
    <p align="center">
        <!--<video autoplay loop controls onclick="this.paused ? this.play() : this.pause();" width=454 height=211 src="EnablingRoutesWired.mp4">-->
        VIDEO
    </p>
    <p>
        We can see two transport paths, one of them is between the <var>source1</var> and the <var>destination1</var>, and the other one is between the <var>source2</var> and the <var>destination2</var>.
    </p>
    <p>
        It's possible to concentrate on one transport path activity.
        We show the traffic between only <var>source1</var> and <var>destination1</var> by using this line of configuration:
    </p>
    <div class="snippet">
        *.visualizer.*.transportRouteVisualizer.nodeFilter = "source1 or switch* or router* or destination1"
    </div>
    <p>
        The filter includes the switches and the routers, because the packet flow goes through the intermediate network devices.
        The following video depicts what happens when we adjust the <i>nodeFilter</i> parameter:
    </p>
    <p align="center">
        <!--<video autoplay loop controls onclick="this.paused ? this.play() : this.pause();" width=454 height=211 src="EnablingRoutesWired.mp4">-->
        VIDEO
    </p>
    <p>
        Howewer there is transport path activity between both source-destination pair, the visualization displays activity only between <var>source1</var> and <var>destination1</var>.
    </p>


    <p><h2>Displaying Activity of Different Applications</h2></p>
    <!--
        TODO: Ha lesz portfilter, akkor az is ide jon
    -->    
    <p>
        In this simulation we visualize the transport path activity of different applications by configuring the <i>packetFilter</i> parameter.
    </p>
    <p>
        The network for this configuration is as follows:
        <img class="screen" src="TransportPathVisualizerServerClients.png">
    </p>
    <p>
        The network consists of a router, two switches and four hosts.
        The <var>admin1</var>, <var>host1</var> and <var>host2</var> have UDP applications.
        The <var>admin1</var> has an <var>UDPBasicApp</var> which communicates with the <var>server</var> on port 22, symbolizing an SSH connection.
        The <var>server</var> handles it with an <var>UDPSink</var> application.
        The <var>host1</var> and the <var>host2</var> have a <var>VideoStreamClient</var> application which is handled by a <var>VideoStreamServer</var> in the <var>server</var>.
        The <var>host1</var> has an additional <var>UDPBasicApp</var>, it symbolizes a TFTP connection.
        Its destination port is 69 in the <var>server</var>.
        The application is handled by an <var>UDPEchoApp</var>.
        Here is the configuration of the visualization:
    </p>
    <div class="snippet">
        *.visualizer.*.transportRouteVisualizer.displayRoutes = true<br>
        *.visualizer.*.transportRouteVisualizer.fadeOutMode = "simulationTime"<br>
        *.visualizer.*.transportRouteVisualizer.fadeOutTime = 0.9s
    </div>
    <p>
        Here is how this looks like:
    </p>
    <p align="center">
        <!--<video autoplay loop controls onclick="this.paused ? this.play() : this.pause();" width=454 height=211 src="EnablingRoutesWired.mp4">-->
        VIDEO before we configure filter
    </p>
    <p>
        To focus only one packet type, we configure the <i>packetFilter</i>.
    </p>
    <div class="snippet">
        *.visualizer.*.transportRouteVisualizer.packetFilter = "*Video*"<br>
    </div>
    <p>
        Here is the result of this parameter setting:
    </p>
    <p align="center">
        <!--<video autoplay loop controls onclick="this.paused ? this.play() : this.pause();" width=454 height=211 src="EnablingRoutesWired.mp4">-->
        VIDEO after we configure filter
    </p>
    <p>
         Now, we can see only the video communication between <var>host2</var> and the <var>server</var> and between <var>host1</var> and the <var>server</var>.
    </p>

    <p><h2>More Information</h2></p>
    <p>
        This example only demonstrated the key features of transport path visualization. For more information, refer to the 
<var>TransportRouteVisualizer</var> NED documentation.
    </p>
</body>

</html>
