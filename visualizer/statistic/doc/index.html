<!DOCTYPE html>
<html>
<head>
<link rel="stylesheet" type="text/css" href="../../../doc/showcases.css">
<title>Visualizing Statistics</title>
</head>

<body>

<h1><center>Visualizing Statistics</center></h1>

<h2>Goals</h2>

<p>
Usually statistics collected while the simulation is running are only analyzed after the simulation has concluded.

In contrast, while the simulation is running it is difficult to follow what's happening in the model in terms of statistics.
For example, in a video streaming network, seeing the throughput for each client gives a quick overview whether the model is working as expected.
</p>

<p>
Statistics collected by submodules can be visualized at network nodes, on the top level canvas. This could help
in troubleshooting and in the early detection of problems in simulation models. 
This showcase contains two example simulations, showing the basics and the more advanced features of the visualization.
</p>

<p>
INET version: <var>3.6</var><br>
Source files location: <var>inet/showcases/visualization/statistic</var>
</p>

<h2>About the visualizer</h2>

<p>
The <var>StatisticVisualizer</var> (included in the network as part of <var>IntegratedVisualizer</var>) is capable of displaying multiple statistics for multiple network nodes.
The visualizer keeps track of the last values of statistics, and displays them next to the
icon of the network node.
</p>

<p>
It subscribes for the signal selected with the
<var>signalName</var> parameter, and displays the statistic selected with the <var>statisticName</var> parameter.
It displays the stastitic of modules that match the expression of the <var>sourceFilter</var> parameter, at the network node that contains the modules. By default, the <var>stastisticName</var> is the same as the <var>signalName</var>.
</p>

<p>TODO: elaborate on the multiple statistics</p>

<p>
The <var>format</var> parameter is a string that specifies how the visualizer displays the statistic value.
The format string can contain the following directives:

<ul>
<li>%s: signal name</li>
<li>%n: statistic name</li>
<li>%v: statistic value</li>
<li>%u: statistic unit</li>
</ul>

The default setting for the format string is <var>"%n %v %u"</var>, i.e. it displays the statistic name, followed by the value and the unit.

The <var>unit</var> parameter selects what unit to display the value in. By default, it is the unit of the statistic.
</p>

<h2>Displaying round trip time of ping packets</h2>

<p>
In the first example simulation, we display the round trip time of ping packets above the nodes. The simulation
can be run by choosing the <var>PingRtt</var> configuration from the ini file. The simulation uses the following simple network:
</p>

<img class="screen" src="rttnetwork.png">

<p>
The network contains two <var>AdhocHosts</var>. The hosts are stationary, and <var>source</var> is configured
to ping <var>destination</var>.
</p>

<p>
The configuration of the visualization in omnetpp.ini is the following:
</p>

<pre class="snippet">
*.visualizer.*.statisticVisualizer.signalName = "rtt"
*.visualizer.*.statisticVisualizer.unit = "ms"
*.visualizer.*.statisticVisualizer.sourceFilter = "**.pingApp[*]"
</pre>

<p>
The signal name is set to <var>rtt</var>, and since there is no statistic name specified, it is also the statistic name.
The unit of the statistic is seconds, but the visualizer is set to display the value in milliseconds. The <var>sourceFilter</var> is not strictly required for this configuration to work, because the <var>signalName</var> parameter is fully specific. The <var>rtt</var> signal is only emitted by <var>pingApp</var> modules, so the default value of <var>sourceFilter</var>, which matches all modules, would suffice.
</p>

<h2>Displaying packet error rate</h2>

<p>
In the second example simulation, the displayed statistic is packet error rate. The simulation can be run by choosing <var>PacketErrorRate</var> from the ini file. The simulation uses the following network:
</p>

<img class="screen" src="pernetwork.png">

<p>
The network contains two <var>AdhocHosts</var>. One of them, the <var>source</var>, is stationary, while the <var>destination</var> is configured to move horizontally
back and forth between its stating position and the right border of the playground. The <var>source</var> is configured to send UDP packets to
<var>destination</var>.
</p>

<p>
The visualizer is configured to display the packet error rate statistic of destination host's <var>radio</var> module:
</p>

<pre class="snippet">
*.visualizer.*.statisticVisualizer.signalName = "packetErrorRate"
*.visualizer.*.statisticVisualizer.sourceFilter = "*.destination.wlan[*].radio"
</pre>


<p>
This animation illustrates what happens when the simulation is run:
</p>

<video controls autoplay loop onclick="this.paused ? this.play() : this.pause();" width="823px" height="420px"><source src="statisticvisualizer5.mp4" type="video/mp4"></video>

<p>
After the first packet exchange, the packet error rate statistic is displayed above both hosts.
The <var>destination</var> host starts moving away from the <var>source</var> host, while the <var>source</var> is sending UDP packets to <var>destination</var>.
Initially, <var>destination's</var> packet error rate statistic is zero, because the hosts are close to each other, and the transmissions are received correctly.
As their distance increases, the packet error rate begins to grow. It becomes one near the edge of <var>source's</var> communication range (displayed as a blue circle). A packet error rate of one means that no packets are received correctly. The packet error rate doesn't become one at exactly the communication range circle,
because the circle is an estimation of <var>source's</var> communication range. When <var>destination</var> turns back and gets into the range again,
the packet error rate starts to decrease, reaching zero when it gets close to <var>source</var>.
</p>

<h2>Further information</h2>

For further information, refer to the <var>InfoVisualizer</var> NED documentation.

</body>

</html>